---
interface Props { title?: string; description?: string }
const { title = "Fernie Real Estate", description = "Fernie neighbourhoods, market info, and listings." } = Astro.props;

const DEV = import.meta.env.DEV;
const MASTER =
  "https://private-office.myrealpage.com/w/w=chris-crump2.myrealpagewebsite.com,m=__manage__/_media/quick-uploads/fernie-homes1600by900cc.webp?inline=true";
const enc = encodeURIComponent(MASTER);
const img = (w:number, fm="avif", q=38) =>
  DEV ? MASTER : `/.netlify/images?url=${enc}&w=${w}&fm=${fm}&q=${q}`;
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>
    <meta name="description" content={description} />

    <link rel="preconnect" href="https://private-office.myrealpage.com" crossorigin>

    {!DEV && (
      <link
        rel="preload" as="image"
        href={img(1600, "avif", 38)}
        imagesrcset={`${img(480,"avif",38)} 480w, ${img(800,"avif",38)} 800w, ${img(1200,"avif",38)} 1200w, ${img(1600,"avif",38)} 1600w`}
        imagesizes="(min-width:1200px) 1200px, 100vw"
        type="image/avif"
        fetchpriority="high"
      />
    )}

    <style>
      :root{--ink:#121212;--bg:#fff}
      html,body{margin:0;padding:0;background:var(--bg);color:var(--ink)}
      body{
        font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif;
      }

      .container{
        max-width:1080px;
        margin-inline:auto;
        padding:0 clamp(12px,2.5vw,24px) clamp(12px,2.5vw,24px);
        display:flow-root;            /* prevent first-child margin collapse */
      }
      .container > :first-child{ margin-top:0 }

      @media (max-width:720px){
        main > *:not(:first-child){
          content-visibility:auto;
          contain-intrinsic-size:800px 1200px;
        }
      }

      h1{line-height:1.15;margin:.25rem 0 1rem}
      h2{margin:1.25rem 0 .75rem}
      h3{margin:1rem 0 .5rem}
      img{max-width:100%;height:auto}
    </style>

    {Astro.head}
  </head>
  <body>
    <div class="container">
      <main><slot /></main>
    </div>
    <slot name="footer" />
  </body>
</html>
